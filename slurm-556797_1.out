/home/zcw7438/.local/lib/python3.6/site-packages/pandas/compat/_optional.py:106: UserWarning: Pandas requires version '1.2.1' or newer of 'bottleneck' (version '1.2.0' currently installed).
  warnings.warn(msg, UserWarning)
/home/zcw7438/.local/lib/python3.6/site-packages/pandas/compat/_optional.py:106: UserWarning: Pandas requires version '2.6.2' or newer of 'numexpr' (version '2.6.1' currently installed).
  warnings.warn(msg, UserWarning)
         dma_code_month  dma_code  ... mint  chocolate
0            529 200601       529  ...    0          0
1            529 200603       529  ...    0          0
3            618 200601       618  ...    0          0
4            640 200602       640  ...    0          0
6            693 200603       693  ...    0          0
...                 ...       ...  ...  ...        ...
26461612     577 200712       577  ...    0          0
26461613     577 200801       577  ...    0          0
26461614     577 200802       577  ...    0          0
26461615     577 200803       577  ...    0          0
26461616     577 200804       577  ...    0          0

[15581665 rows x 11 columns]
         dma_code_month  dma_code owner initial  ...  cocoa_beans  mint  chocolate
0                   NaN       NaN           NaN  ...          NaN   NaN        NaN
1                   NaN       NaN           NaN  ...          NaN   NaN        NaN
3                   NaN       NaN           NaN  ...          NaN   NaN        NaN
4                   NaN       NaN           NaN  ...          NaN   NaN        NaN
6                   NaN       NaN           NaN  ...          NaN   NaN        NaN
...                 ...       ...           ...  ...          ...   ...        ...
26461612            NaN       NaN           NaN  ...          NaN   NaN        NaN
26461613            NaN       NaN           NaN  ...          NaN   NaN        NaN
26461614            NaN       NaN           NaN  ...          NaN   NaN        NaN
26461615            NaN       NaN           NaN  ...          NaN   NaN        NaN
26461616            NaN       NaN           NaN  ...          NaN   NaN        NaN

[15581665 rows x 11 columns]
dma_code_month        NaN
dma_code              NaN
owner initial         NaN
log_adjusted_price    NaN
upc                   NaN
market_share          NaN
distance              NaN
sugar                 NaN
cocoa_beans           NaN
mint                  NaN
chocolate             NaN
Name: 0, dtype: object
Empty DataFrame
Columns: [dma_code_month, dma_code, owner initial, log_adjusted_price, upc, market_share, distance, sugar, cocoa_beans, mint, chocolate]
Index: []
Initializing the problem ...
Traceback (most recent call last):
  File "plainLogit.py", line 39, in <module>
    GenerateDEData(products, quarterOrMonth, inputs, characteristics)
  File "plainLogit.py", line 25, in GenerateDEData
    problem = pyblp.Problem(logit_formulation, demand_estimation_data)
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pyblp/economies/problem.py", line 1193, in __init__
    products = Products(product_formulations, product_data, add_exogenous=add_exogenous)
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pyblp/primitives.py", line 140, in __new__
    raise KeyError("product_data must have a market_ids field.")
KeyError: 'product_data must have a market_ids field.'
