  0%|          | 0/4 [00:00<?, ?it/s]sys:1: DtypeWarning: Columns (18,22,30,36,38) have mixed types. Specify dtype option on import or set low_memory=False.
GenerateDemandEstimationData.py:174: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  year_data[characteristic] = year_data['upc'].map(features_map[characteristic])
 25%|██▌       | 1/4 [00:05<00:16,  5.64s/it] 50%|█████     | 2/4 [00:12<00:12,  6.15s/it]sys:1: DtypeWarning: Columns (18,22,24,28,30,36,38) have mixed types. Specify dtype option on import or set low_memory=False.
 75%|███████▌  | 3/4 [00:17<00:05,  5.71s/it]sys:1: DtypeWarning: Columns (22,30) have mixed types. Specify dtype option on import or set low_memory=False.
100%|██████████| 4/4 [00:22<00:00,  5.43s/it]100%|██████████| 4/4 [00:22<00:00,  5.61s/it]
(1721493, 38)
Index(['Unnamed: 0', 'upc', 'dma_code', 'month', 'volume', 'price',
       'size1_amount', 'size1_units', 'brand_descr', 'owner initial',
       'owner last', 'y-m-d', 'year', '# month', 'market_size',
       'market_size_DMA', 'market_share', 'postmerger', 'month_since_start',
       'involved', 'involvedpostmerger', 'product-region', 'time', 'cpiu',
       'price_index', 'adjusted_price', 'log_adjusted_price',
       'hhinc_per_person_mean', 'hhinc_per_person_median', 'employment_rate',
       'adjusted_hhinc_per_person_mean', 'log_adjusted_hhinc_per_person_mean',
       'log_employment_rate', 'product', 'upc_dma_code', 'distance', 'y-m',
       'style_descr'],
      dtype='object')
        time     wheat        t
0   7/1/1959  1.954636  1959-07
1   8/3/1959  1.958810  1959-08
2   9/1/1959  1.962905  1959-09
3  10/1/1959  1.981318  1959-10
4  11/2/1959  2.005690  1959-11
       time  barley        t
0  4/1/2000   76.95  2000-04
1  5/1/2000   78.26  2000-05
2  6/1/2000   78.48  2000-06
3  7/1/2000   78.68  2000-07
4  8/1/2000   75.13  2000-08
             y-m  postmerger
0        2006-01           0
1        2006-01           0
2        2006-01           0
3        2006-01           0
4        2006-01           0
...          ...         ...
1721488  2008-04           0
1721489  2008-04           0
1721490  2008-04           0
1721491  2008-04           0
1721492  2008-04           0

[1721493 rows x 2 columns]
             y-m  postmerger
0        2006-01           0
1        2006-01           0
2        2006-01           0
3        2006-01           0
4        2006-01           0
...          ...         ...
1721488  2008-04           0
1721489  2008-04           0
1721490  2008-04           0
1721491  2008-04           0
1721492  2008-04           0

[1721493 rows x 2 columns]
0          500200601
1          501200601
2          502200601
3          503200601
4          504200601
             ...    
1721488    616200804
1721489    679200804
1721490    717200804
1721491    753200804
1721492    758200804
Name: dma_code_month, Length: 1721493, dtype: object
['dma_code_month', 'adjusted_price', 'market_share', 'month_since_start', 'upc', 'dma_code', 'owner initial', 'brand_descr', 'distance', 'style_descr', 'wheat', 'barley']
  dma_code_month  adjusted_price  ...     wheat      barley
0      500200601        0.134551  ...  4.356919  134.774562
1      501200601        0.127685  ...  4.356919  134.774562
2      502200601        0.113288  ...  4.356919  134.774562
3      503200601        0.109541  ...  4.356919  134.774562
4      504200601        0.129549  ...  4.356919  134.774562

[5 rows x 12 columns]
  market_ids    prices  ...  demand_instruments0  demand_instruments1
0  500200601  0.134551  ...             4.356919           134.774562
1  501200601  0.127685  ...             4.356919           134.774562
2  502200601  0.113288  ...             4.356919           134.774562
3  503200601  0.109541  ...             4.356919           134.774562
4  504200601  0.129549  ...             4.356919           134.774562

[5 rows x 12 columns]
0          500200601
1          501200601
2          502200601
3          503200601
4          504200601
             ...    
1721488    616200804
1721489    679200804
1721490    717200804
1721491    753200804
1721492    758200804
Name: market_ids, Length: 1721493, dtype: object
Initializing the problem ...
Absorbing demand-side fixed effects ...
Initialized the problem after 00:00:38.

Dimensions:
====================================
 T       N      F    K1    MD    ED 
----  -------  ---  ----  ----  ----
6058  1721493  28    2     4     2  
====================================

Formulations:
========================================
     Column Indices:          0      1  
--------------------------  ------  ----
X1: Linear Characteristics  prices  time
========================================
Dimensions:
====================================
 T       N      F    K1    MD    ED 
----  -------  ---  ----  ----  ----
6058  1721493  28    2     4     2  
====================================

Formulations:
========================================
     Column Indices:          0      1  
--------------------------  ------  ----
X1: Linear Characteristics  prices  time
========================================
Solving the problem ...
Updating the weighting matrix ...
Computed results after 00:00:02.

Problem Results Summary:
=====================================
GMM     Objective    Weighting Matrix
Step      Value      Condition Number
----  -------------  ----------------
 1    +1.041703E+04   +1.250596E+05  
=====================================

Estimating standard errors ...
Computed results after 00:00:02.

Problem Results Summary:
========================================================
GMM     Objective    Weighting Matrix  Covariance Matrix
Step      Value      Condition Number  Condition Number 
----  -------------  ----------------  -----------------
 2    +8.190889E+02   +1.910760E+05      +1.601990E+09  
========================================================

Cumulative Statistics:
========================
Computation   Objective 
   Time      Evaluations
-----------  -----------
 00:00:03         2     
========================

Beta Estimates (Robust SEs in Parentheses):
================================
    prices            time      
---------------  ---------------
 -3.197863E+02    -9.107847E-03 
(+1.199335E+01)  (+9.838747E-04)
================================
Problem Results Summary:
========================================================
GMM     Objective    Weighting Matrix  Covariance Matrix
Step      Value      Condition Number  Condition Number 
----  -------------  ----------------  -----------------
 2    +8.190889E+02   +1.910760E+05      +1.601990E+09  
========================================================

Cumulative Statistics:
========================
Computation   Objective 
   Time      Evaluations
-----------  -----------
 00:00:03         2     
========================

Beta Estimates (Robust SEs in Parentheses):
================================
    prices            time      
---------------  ---------------
 -3.197863E+02    -9.107847E-03 
(+1.199335E+01)  (+9.838747E-04)
================================
Initializing the problem ...
Absorbing demand-side fixed effects ...
Initialized the problem after 00:00:51.

Dimensions:
=========================================
 T       N      F    K1    MD    ED    H 
----  -------  ---  ----  ----  ----  ---
6058  1721493  28    2     4     2     1 
=========================================

Formulations:
========================================
     Column Indices:          0      1  
--------------------------  ------  ----
X1: Linear Characteristics  prices  time
========================================
Solving the problem ...

Rho Initial Values:
=============
 All Groups  
-------------
+7.000000E-01
=============

Rho Lower Bounds:
=============
 All Groups  
-------------
+0.000000E+00
=============

Rho Upper Bounds:
=============
 All Groups  
-------------
+9.900000E-01
=============

Starting optimization ...

GMM   Optimization   Objective   Fixed Point  Contraction    Objective      Objective      Projected                 
Step   Iterations   Evaluations  Iterations   Evaluations      Value       Improvement   Gradient Norm      Theta    
----  ------------  -----------  -----------  -----------  -------------  -------------  -------------  -------------
 1         0             1            0            0       +4.643039E+03                 +6.324873E+03  +7.000000E-01
 1         0             2            0            0       +3.039944E+03  +1.603095E+03  +0.000000E+00  +9.900000E-01

Optimization completed after 00:02:13.
Computing the Hessian and and updating the weighting matrix ...
Computed results after 00:02:57.

Problem Results Summary:
===================================================================
GMM     Objective      Projected       Reduced     Weighting Matrix
Step      Value      Gradient Norm     Hessian     Condition Number
----  -------------  -------------  -------------  ----------------
 1    +3.039944E+03  +0.000000E+00  +0.000000E+00   +1.250596E+05  
===================================================================

Starting optimization ...

GMM   Optimization   Objective   Fixed Point  Contraction    Objective      Objective      Projected                 
Step   Iterations   Evaluations  Iterations   Evaluations      Value       Improvement   Gradient Norm      Theta    
----  ------------  -----------  -----------  -----------  -------------  -------------  -------------  -------------
 2         0             1            0            0       +1.147499E+02                 +0.000000E+00  +9.900000E-01

Optimization completed after 00:01:06.
Computing the Hessian and estimating standard errors ...
Computed results after 00:02:49.

Problem Results Summary:
======================================================================================
GMM     Objective      Projected       Reduced     Weighting Matrix  Covariance Matrix
Step      Value      Gradient Norm     Hessian     Condition Number  Condition Number 
----  -------------  -------------  -------------  ----------------  -----------------
 2    +1.147499E+02  +0.000000E+00  +0.000000E+00   +1.990955E+05      +2.722268E+09  
======================================================================================

Cumulative Statistics:
======================================
Computation  Optimization   Objective 
   Time       Iterations   Evaluations
-----------  ------------  -----------
 00:09:04         1             5     
======================================

Rho Estimates (Robust SEs in Parentheses):
===============
  All Groups   
---------------
 +9.900000E-01 
(+1.083369E-01)
===============

Beta Estimates (Robust SEs in Parentheses):
================================
    prices            time      
---------------  ---------------
 -4.446510E+02    -1.564120E-02 
(+2.123719E+01)  (+1.506815E-03)
================================
Problem Results Summary:
======================================================================================
GMM     Objective      Projected       Reduced     Weighting Matrix  Covariance Matrix
Step      Value      Gradient Norm     Hessian     Condition Number  Condition Number 
----  -------------  -------------  -------------  ----------------  -----------------
 2    +1.147499E+02  +0.000000E+00  +0.000000E+00   +1.990955E+05      +2.722268E+09  
======================================================================================

Cumulative Statistics:
======================================
Computation  Optimization   Objective 
   Time       Iterations   Evaluations
-----------  ------------  -----------
 00:09:04         1             5     
======================================

Rho Estimates (Robust SEs in Parentheses):
===============
  All Groups   
---------------
 +9.900000E-01 
(+1.083369E-01)
===============

Beta Estimates (Robust SEs in Parentheses):
================================
    prices            time      
---------------  ---------------
 -4.446510E+02    -1.564120E-02 
(+2.123719E+01)  (+1.506815E-03)
================================
