/home/zcw7438/.local/lib/python3.6/site-packages/pandas/compat/_optional.py:106: UserWarning: Pandas requires version '1.2.1' or newer of 'bottleneck' (version '1.2.0' currently installed).
  warnings.warn(msg, UserWarning)
/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/groupby/generic.py:1455: FutureWarning: using a dict with renaming is deprecated and will be removed
in a future version.

For column-specific groupby renaming, use named aggregation

    >>> df.groupby(...).agg(name=('column', aggfunc))

  return super().aggregate(arg, *args, **kwargs)
Traceback (most recent call last):
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/indexes/base.py", line 2897, in get_loc
    return self._engine.get_loc(key)
  File "pandas/_libs/index.pyx", line 107, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 131, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1607, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1614, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'owner company'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "AggregateToMonthOrQuarter_A.py", line 63, in <module>
    Limit_to_Top100_and_Aggregate_to_quarter_or_month(product, quarterOrmonth, mergingtime)
  File "AggregateToMonthOrQuarter_A.py", line 48, in Limit_to_Top100_and_Aggregate_to_quarter_or_month
    Aggregate_to_Month(top100brand_data)
  File "AggregateToMonthOrQuarter_A.py", line 12, in Aggregate_to_Month
    panel_data = top100brand_data.groupby(['upc','dma_code','month']).agg({'volume': 'sum', 'price': 'mean', 'brand_descr': 'first', 'owner company': 'first'})
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/groupby/generic.py", line 1455, in aggregate
    return super().aggregate(arg, *args, **kwargs)
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/groupby/generic.py", line 229, in aggregate
    result, how = self._aggregate(func, _level=_level, *args, **kwargs)
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/base.py", line 506, in _aggregate
    result = _agg(arg, _agg_1dim)
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/base.py", line 456, in _agg
    result[fname] = func(fname, agg_how)
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/base.py", line 435, in _agg_1dim
    colg = self._gotitem(name, ndim=1, subset=subset)
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/groupby/generic.py", line 1487, in _gotitem
    subset = self.obj[key]
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/frame.py", line 2995, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/zcw7438/.local/lib/python3.6/site-packages/pandas/core/indexes/base.py", line 2899, in get_loc
    return self._engine.get_loc(self._maybe_cast_indexer(key))
  File "pandas/_libs/index.pyx", line 107, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 131, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 1607, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 1614, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'owner company'
